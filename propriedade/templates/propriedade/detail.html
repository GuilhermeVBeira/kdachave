{% extends 'base.html' %} {% block content %}
<div class="container-fluid">

    <div class="row ">
        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
            <div class="card">
                <div class="header">
                    <div class="row clearfix">
                        <div class="col-xs-12 col-sm-6">
                            <h2>Title black</h2>
                        </div>

                        <!-- <div class="col-xs-12 col-sm-6 align-right">
                                <div class="panel-switch-btn">
                                      <a href="{% url 'propriedade:create' %}" class="btn btn-primary">Nova</a>
                                </div>
                            </div> -->
                    </div>
                    <!-- <ul class="header-dropdown m-r--5">
                            <li class="dropdown">
                                <a href="javascript:void(0);" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
                                    <i class="material-icons">more_vert</i>
                                </a>
                                <ul class="dropdown-menu pull-right">
                                    <li><a href="javascript:void(0);">Action</a></li>
                                    <li><a href="javascript:void(0);">Another action</a></li>
                                    <li><a href="javascript:void(0);">Something else here</a></li>
                                </ul>
                            </li>
                        </ul> -->
                </div>
                <div class="body">
                    <div class="container-fluid">
                        <div class="row">
                            <div class="col-md-12">
                                <h3>
                                    h3. Lorem ipsum dolor sit amet.
                                </h3>
                                <ul>
                                    <li>
                                        Lorem ipsum dolor sit amet
                                    </li>
                                    <li>
                                        Consectetur adipiscing elit
                                    </li>
                                    <li>
                                        Integer molestie lorem at massa
                                    </li>
                                    <li>
                                        Facilisis in pretium nisl aliquet
                                    </li>
                                    <li>
                                        Nulla volutpat aliquam velit
                                    </li>
                                    <li>
                                        Faucibus porta lacus fringilla vel
                                    </li>
                                    <li>
                                        Aenean sit amet erat nunc
                                    </li>
                                    <li>
                                        Eget porttitor lorem
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-12">
                                <div class="panel panel-default">
                                    <div class="panel-heading">
                                        <h3 class="panel-title pull-left">
                                            Autorizações
                                        </h3>
                                        <a id="modal-511775" href="#modal-container-511775" propriedadeId="{{propriedade.pk}}" tipo="autorizacao" role="button" class="btn btn-primary pull-right btn-new" data-toggle="modal">Nova</a>
                                        <div class="clearfix"></div>
                                    </div>
                                    <div class="panel-body">
                                        <div class="panel-group" id="panel-538665">
                                            
                                            {% for autorizacao in propriedade.autorizacao_set.all %}
                                            <div class="panel panel-default">
                                                <div class="panel-heading">
                                                    <a class="panel-title collapsed" data-toggle="collapse" data-parent="#panel-{{autorizacao.pk}}" href="#panel-element-{{autorizacao.pk}}">{{autorizacao.autorizada}}  {{autorizacao.dataFim|date:'d/m/Y'}}</a>
                                                </div>
                                                <div id="panel-element-{{autorizacao.pk}}" class="panel-collapse collapse">
                                                    <div class="panel-body">
                                                        {{autorizacao.descricao}}
                                                    </div>
                                                </div>
                                            </div>
                                            {% endfor %}
                                        </div>
                                    </div>
                                    <!-- <div class="panel-footer">
                                            Panel footer
                                        </div> -->
                                </div>

                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-12">
                                <div class="panel panel-default">
                                    <div class="panel-heading">
                                        <h3 class="panel-title pull-left">
                                            Molhos
                                        </h3>
                                        <a id="modal-511775" href="#modal-container-511775" propriedadeId="{{propriedade.pk}}" tipo="molho" role="button" class="btn btn-primary pull-right btn-new" data-toggle="modal">Novo</a>
                                        <div class="clearfix"></div>
                                    </div>
                                    <div class="panel-body">
                                        <div class="row clearfix">
                                            <div class="col-lg-3 col-md-3 col-sm-6 col-xs-12">
                                                <div class="info-box bg-pink hover-expand-effect">
                                                    <div class="icon">
                                                        <i class="material-icons">playlist_add_check</i>
                                                    </div>
                                                    <div class="content">
                                                        <div class="text">Novas Tarefas</div>
                                                        <div class="number count-to" data-from="0" data-to="125" data-speed="15" data-fresh-interval="20"></div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-lg-3 col-md-3 col-sm-6 col-xs-12">
                                                <div class="info-box bg-cyan hover-expand-effect">
                                                    <div class="icon">
                                                        <i class="material-icons">help</i>
                                                    </div>
                                                    <div class="content">
                                                        <div class="text">NEW TICKETS</div>
                                                        <div class="number count-to" data-from="0" data-to="257" data-speed="1000" data-fresh-interval="20"></div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-lg-3 col-md-3 col-sm-6 col-xs-12">
                                                <div class="info-box bg-light-green hover-expand-effect">
                                                    <div class="icon">
                                                        <i class="material-icons">forum</i>
                                                    </div>
                                                    <div class="content">
                                                        <div class="text">NEW COMMENTS</div>
                                                        <div class="number count-to" data-from="0" data-to="243" data-speed="1000" data-fresh-interval="20"></div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-lg-3 col-md-3 col-sm-6 col-xs-12">
                                                <div class="info-box bg-orange hover-expand-effect">
                                                    <div class="icon">
                                                        <i class="material-icons">person_add</i>
                                                    </div>
                                                    <div class="content">
                                                        <div class="text">NEW VISITORS</div>
                                                        <div class="number count-to" data-from="0" data-to="1225" data-speed="1000" data-fresh-interval="20"></div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- <div class="panel-footer">
                                            Panel footer
                                        </div> -->
                                </div>

                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="modal-container-511775" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">

                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                    ×
                </button>
                <h4 class="modal-title" id="myModalLabel">
                    Modal title
                </h4>
            </div>
            <div class="modal-body">
            </div>

        </div>

    </div>

</div>
{% endblock %}

{% block extrajs %}
<script>
    $(document).ready(function(){
        $('.btn-new').on('click',function(){
          var tipo = $(this).attr('tipo');
          var propriedadeId = $(this).attr('propriedadeId');

          if(tipo === "autorizacao"){
            //chama ajax de autorização
            var durl = window.location.protocol+'//'+window.location.host+"/autorizacao/create/"+propriedadeId+"/";
            $.ajax({
                type: "GET",
                url: durl,
                success: function(data){
                    html = $.parseHTML(data);
                    $('.modal-title').html("Nova Autorização");

                    $('.modal-body').html(html);
                    $('form', $('.modal-body')).attr('action', durl);

                    $('form', $('.modal-body')).submit(function(e){
                        e.preventDefault();
                        $.ajax({
                            type: "POST",
                            url: durl,
                            data: $('form', $('.modal-body')).serialize(),
                            success: function(data){
                                $('.modal').modal('hide');
                            },
                            error: function (data, xhr, ajaxOptions, thrownError) {
                                $('.modal-body').html(data.responseText);
                            }
                        });
                    });
                }
            });
          }else{
              //chama ajax de Molho

          }
        });
    });
</script>
{% endblock extrajs %}
